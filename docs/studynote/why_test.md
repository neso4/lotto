# 테스트 코드를 작성하는 이유에 대해서

2주차 피드백에 다음과 같은 질문이 있었습니다.

> 테스트를 작성하는 이유에 대해 본인의 경험을 토대로 정리해본다
> 단지 기능을 점검하기 위한 목적으로 테스트를 작성하는 것은 아니다. 테스트를 작성하는 과정을 통해서 나의 코드에 대해 빠르게 피드백을 받을 수 있을 뿐만 아니라 학습 도구(학습테스트를 통해 JUnit
> 학습하기.pdf)로도 활용할 수 있다. 이런 경험을 통해 테스트에 대해 어떤 유용함을 느꼈는지 알아본다.
>
---

# 테스트와 유지보수

처음엔 매우 당연하고 간단하며 쓸 데 없이 코드는 길고 시간도 오래 소요되는 테스트 코드 작성이 의미가 없다고 느껴졌습니다.

그래도 조금 쓰다보니 테스트 코드의 유용성을 어렴풋이는 알고 있었는데,

프리코스를 진행하면서 테스트 코드와 함께 계속해서 리팩토링을 거듭하면서 테스트 코드의 진가를 직접 느껴볼 수 있었습니다.

미션 내내 최대한 구조를 나누고 변경해보는 것이 목적이었기 때문에 리팩토링을 상당히 많이 했는데,

그 과정에서 같은 기능을 계속해서 다른 방식으로 재작성 하게 되었습니다.

오류 없이 그대로 돌아갔다면 그 때는 좋았겠지만, 깨달음을 얻을 기회는 뒤로 미뤄졌을 것입니다.

리팩토링을 하면서 테스트를 돌려볼 때마다 계속해서 오류가 발생했는데,

테스트 케이스를 꽤 많이 작성한 덕분에 어떤 기능이 제대로 동작하지 않는지 바로 알 수 있었습니다.

IDE 덕분에 기능을 추가/변경할 때마다 단축키 한 방에 모든 테스트를 빠르게 돌려볼 수 있었고,

`@DisplayName`에 묘사된 테스트 설명이 어떤 기능에 문제가 생겼는지 즉시 알아볼 수 있도록 도와주었습니다.

이렇게 테스트가 뒷받침 해주는 환경이 조성되자, 리팩토링을 상당히 공격적으로 시도할 수 있었습니다.

항상 코드가 많아지고 복잡해질수록 점점 제 코드를 알아보기 어려워지고, 코드 읽기도 피로도가 높아져서 버리고 다른 코드를 작성하기 다반사였는데,

꽤나 길어진 코드의 상당량을 지속적으로 수정하면서도 문제가 생기면 빠르게 찾고 고쳐보는 경험을 하니, 테스트에 대한 흥미도 깊어지고 제대로 공부해봐야 겠다는 생각도 들었습니다.

현업에서 그렇게 테스트를 많이 짠다고 들었는데, 그 이유도 명확히 이해할 수 있게 되었습니다.

처음 개발 공부를 시작할 때, JS와 Python 등의 동적 타입 언어만 만지다가 강타입 언어를 사용할 때는 유용성을 느끼지 못했으나,

시간이 지나면서 강타입 언어의 진정한 힘을 깨달았을 때와 비슷한 느낌입니다.

이제 다시는 동적 타입 언어를 사용할 수 없을 것이고,

다시는 테스트 없이 코드를 작성하지 못할 것 같습니다.

문법 오류는 컴파일러가, 논리적 오류는 테스트가 보조한다면 훨씬 더 오류를 줄일 수 있겠습니다.

개념 상으로 프로그램 변경 중 뜻하게 발생되는 회귀 버그를 찾아낼 수 있다는 설명을 읽는 것보다,

이렇게 직접 리팩토링을 하면서 몸으로 체험하는 것이 훨씬 더 효과가 좋은 것 같습니다.

그 전에 읽었던 설명들이 붕 떠있다가 흡수가 되는 것 같네요.

물론 테스트도 결국 사람이 짜는 것이니까 논리적인 구멍은 잡아낼 수 없을테니 그 부분은 조심해야할 듯 싶습니다.

그래서 우아한 테크코스에서 페어 프로그래밍 등을 하면서 교차 검증을 해서 논리적 구멍을 잡아내는 것이지 않나 라는 생각도 드네요.

배포시에도 자동화된 테스팅을 해야 한다는 말을 많이 봤는데,

실제로 서비스가 돌아가도록 배포하기 전에 테스트를 통해 자동으로 논리적 오류를 잡도록 만든다면,

마치 웹서버의 미들웨어에서 필터링 하듯이, 테스트 실패하면 배포가 진행되지 못하도록 막는 개념이겠구나 싶었습니다.

구글 크롬 등의 어플리케이션을 빌드하는데 수십 분에서 수 시간이 걸린다고 들었는데,

상용 서버의 경우 정확히는 모르겠으나 빌드 시간이 꽤나 걸릴 것이라고 생각합니다.

그래서 테스트가 실패한 잘못된 버전을 올리게 되면 코드를 고치고 빌드해서 재배포 하는데 시간이 꽤 걸릴 것이기 때문에

애초에 테스트가 성공했을 경우에만 통과시키는 것이 합리적이겠다는 당연한 사실에 대해서도 생각해봤습니다.

테스트로 필터링을 하지 않고 그냥 배포해버리면 사용자에게 테스트를 맡기는 것이나 다름 없을테니까요.

---

정리하면 테스트로 인해 코드가 복잡해지더라도 리팩토링을 편하게 할 수 있습니다.

컴파일 오류 및 논리적 오류를 둘 다 잡아주기 때문에,

테스트 없이 리팩토링을 한다면 논리적 오류가 발생한 코드들이 모르는 새에 점점 늘어나서

언젠가 눈덩이처럼 불어나게 될텐데,

테스트는 그걸 실시간으로 잡아주기 때문입니다.

그리고 배포 관점에서 생각해보면 논리적 오류가 포함된, 잘못된 어플리케이션을 사용자가 쓰게 만들 가능성을 줄여줍니다.

그리고 문서 역할도 한다고 봤는데, `@DisplayName`에 한글로 설명을 적을 수 있어서 알아보기 편했던 것을 떠올려보면 맞다고 생각합니다.

---
