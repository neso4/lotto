# 📋 기능 설계서

## 🚀 로또 게임 규칙

로또 게임은 아래와 같은 규칙으로 진행된다.

```
- 로또 번호의 숫자 범위는 1~45까지이다.
- 1개의 로또를 발행할 때 중복되지 않는 6개의 숫자를 뽑는다.
- 당첨 번호 추첨 시 중복되지 않는 숫자 6개와 보너스 번호 1개를 뽑는다.
- 당첨은 1등부터 5등까지 있다. 당첨 기준과 금액은 아래와 같다.
    - 1등: 6개 번호 일치 / 2,000,000,000원
    - 2등: 5개 번호 + 보너스 번호 일치 / 30,000,000원
    - 3등: 5개 번호 일치 / 1,500,000원
    - 4등: 4개 번호 일치 / 50,000원
    - 5등: 3개 번호 일치 / 5,000원
```

* 로또 구입 금액을 입력하면 구입 금액에 해당하는 만큼 로또를 발행해야 한다.
* 로또 1장의 가격은 1,000원이다.
* 당첨 번호와 보너스 번호를 입력받는다.
* 사용자가 구매한 로또 번호와 당첨 번호를 비교하여 당첨 내역 및 수익률을 출력하고 로또 게임을 종료한다.

## 🧙🏻 MVC 패턴에 따른 기능 목록

### 🖼️ view

#### InputValidator

사용자 입력(String 타입)을 검증하는 역할을 하는 클래스입니다.

* 구입 금액 입력 검증
    * 정수여야 합니다.
    * 양수여야 합니다.
    * 정수로 변환 후, 1000으로 나누어 떨어져야 합니다.
* 당첨 번호 입력 검증
    * `,` 단위로 당첨 번호가 구분됩니다.
    * 당첨 번호의 개수는 6개여야 합니다.
    * 당첨 번호를 각각 검증합니다.
        * 정수여야 합니다.
        * 1~45 사이 값이어야 합니다.
    * 당첨 번호 간 숫자가 중복되지 않아야 합니다.
* 보너스 번호 입력 검증
    * 정수여야 합니다.
    * 1~45 사이 값이어야 합니다.

#### InputView

사용자로부터 입력을 받아오는 역할을 하는 클래스입니다.

사용자로부터 입력 받은 값을 InputValidator를 이용하여 간단한 검증 기능을 수행합니다.

사용자로부터 입력받은 값을 String 타입으로 InputController에 전달합니다.

#### OutputView

사용자에게 원하는 결과를 출력하는 역할을 하는 클래스입니다.

출력되는 화면의 내용 중, 업데이트 되는 영역과 업데이트 되지 않는 영역을 따로 관리합니다.

예를 들어 아래가 사용자에게 보여질 화면의 예시라고 하면

```
8개를 구매했습니다.
[8, 21, 23, 41, 42, 43] 
[3, 5, 11, 16, 32, 38] 
[7, 11, 16, 35, 36, 44] 
[1, 8, 11, 31, 41, 42] 
[13, 14, 16, 38, 42, 45] 
[7, 11, 30, 40, 42, 43] 
[2, 13, 22, 32, 38, 45] 
[1, 3, 5, 14, 22, 45]

3개 일치 (5,000원) - 1개
4개 일치 (50,000원) - 0개
5개 일치 (1,500,000원) - 0개
5개 일치, 보너스 볼 일치 (30,000,000원) - 0개
6개 일치 (2,000,000,000원) - 0개

총 수익률은 62.5%입니다.
```

중괄호`{}` 안에 있는 내용이 업데이트 되는 영역입니다.

```
{구매한 로또 개수}개를 구매했습니다.

{구매한 로또 목록}

{당첨 개수 통계}
총 수익률은 {수익률}%입니다.
```

OutputController로부터 업데이트 되는 영역의 내용을 받아 출력될 화면을 업데이트 합니다.

OutputController로부터 사용자에게 적절한 화면을 출력할 것을 요청받습니다.

### 🧑 model

#### Lotto

* 로또 번호 리스트를 갖고 있습니다.
    * 생성자 검증
        * null이 아니어야 합니다.
        * 당첨 번호 리스트의 크기는 6이어야 합니다.
        * 1~45 사이 정수여야 합니다.
        * 숫자가 중복되지 않아야 합니다.

#### WinningLotto

* 당첨 번호와 보너스 번호를 갖고 있습니다.
    * 생성자 검증
        * null이 아니어야 합니다.
        * 보너스 번호는 1~45 사이 정수여야 합니다.
        * 보너스 번호와 당첨 번호 사이에 중복된 값이 없어야 합니다.

#### LottoMachine

로또 판매점에서 자동으로 로또 번호를 생성해주는 로또 기계 역할을 하는 클래스입니다.

* 랜덤으로 로또를 1개 생성하는 함수를 갖고 있습니다.
    * 1~45 사이 중복 되지 않은 6개의 수를 뽑아 Lotto 객체를 생성합니다.
    * `camp.nextstep.edu.missionutils.Randoms`의 `pickUniqueNumbersInRange()`를 활용합니다.
* 랜덤으로 로또를 n개 생성해서 List<Lotto>를 반환하는 함수를 갖고 있습니다.
* 로또의 가격을 확인할 수 있습니다.

#### LottoShop

로또 판매점 역할을 하는 클래스입니다.

* 로또 기계(LottoMachine)를 갖고 있습니다.
* 받은 금액만큼 로또를 생성합니다.
    * 받은 금액 검증
        * 양수여야 합니다.
        * 로또 가격(1000)의 배수여야 합니다.
* 로또 가격을 확인할 수 있습니다.

#### Player

로또 구매자 역할을 하는 클래스입니다.

* 초기 예산을 갖고 있습니다.
* 로또를 구매하는데 사용한 금액을 갖고 있습니다.
* 구입한 로또 리스트를 갖고 있습니다.
* 본인이 구입한 로또 리스트에 대한 당첨 개수 통계 결과와 수익률 정보(WinningStatistics)를 갖고 있습니다.

* 로또 판매점에서 로또를 구매할 수 있습니다.
* 당첨 번호와 본인이 구매한 로또 리스트를 비교하여 당첨 개수 통계를 내고 수익률을 계산할 수 있습니다.

#### WinningStatistics

당첨 통계에 대한 정보를 갖고 있는 역할을 하는 클래스입니다.

* 당첨 번호와 보너스 번호(WinningLotto)와 당첨을 맞춰볼 로또 번호 리스트를 갖고 있습니다.
* WinningLotto를 토대로 계산된 당첨 개수 통계와 수익률 정보를 갖고 있습니다.

### 🌉 controller

#### InputController

LottoGameService는 사용자 입력이 필요할 때마다 InputController를 통해 사용자 입력을 받아옵니다.

InputController는 InputView로부터 사용자 입력(String)을 받아옵니다.

String 타입의 사용자 입력을 InputController에서 적절한 model 타입(LottoGameService에서 요청한 model 타입)으로 변환합니다.

LottoGameService에게 변환한 객체를 넘겨줍니다.

#### OutputController

OutputController는 LottoGameService로부터 사용자에게 화면을 출력할 것을 요청받습니다.

OutputView에서 업데이트가 될 화면(String)을 생성합니다.

OutputView에게 전달하여 사용자에게 보여질 화면을 업데이트하고 렌더링할 것을 요청합니다.

### 🎮 service

#### **LottoGameService**

로또 게임의 비즈니스 로직을 수행하는 클래스입니다.

로또 구매자(`Player` 객체)와 로또 판매점(`LottoShop` 객체)을 통해 로또 게임을 진행합니다.

사용자 입력이 필요한 경우 InputController를 통해 받습니다.

OutputController를 통해 사용자에게 원하는 화면을 출력하도록 합니다.

* 실행 흐름

1. 사용자로부터 예산을 입력 받습니다.
    * 입력받은 예산을 Player 객체에게 부여합니다.
2. Player 객체는 가지고 있는 예산으로 로또 판매점(LottoShop)에서 로또를 구매합니다.
    * 구매한 로또 목록을 사용자 화면에 출력하도록 합니다.
3. 사용자로부터 당첨 번호, 보너스 번호를 입력 받습니다.
4. Player 객체는 사용자로부터 입력받은 당첨 번호, 보너스 번호를 본인이 구매한 로또 번호와 비교하여 당첨 개수 통계와 수익률을 계산합니다.
    * 계산한 당첨 개수 통계와 수익률을 사용자 화면에 출력하도록 합니다.

### 입출력 흐름

#### [입력 흐름](https://ibb.co/56GKZWR)

<img src="https://i.ibb.co/80NYkD7/drawio.png">

#### [출력 흐름](https://ibb.co/B3HXmvF)

<img src="https://i.ibb.co/jf9cdqs/image.png">

## 전체 입출력 예시

```
구입금액을 입력해 주세요.
8000

8개를 구매했습니다.
[8, 21, 23, 41, 42, 43] 
[3, 5, 11, 16, 32, 38] 
[7, 11, 16, 35, 36, 44] 
[1, 8, 11, 31, 41, 42] 
[13, 14, 16, 38, 42, 45] 
[7, 11, 30, 40, 42, 43] 
[2, 13, 22, 32, 38, 45] 
[1, 3, 5, 14, 22, 45]

당첨 번호를 입력해 주세요.
1,2,3,4,5,6

보너스 번호를 입력해 주세요.
7

당첨 통계
---
3개 일치 (5,000원) - 1개
4개 일치 (50,000원) - 0개
5개 일치 (1,500,000원) - 0개
5개 일치, 보너스 볼 일치 (30,000,000원) - 0개
6개 일치 (2,000,000,000원) - 0개
총 수익률은 62.5%입니다.
```

---

## 🎯 프로그래밍 요구 사항

### 🔒 라이브러리(?) 제약 사항

- 사용자가 입력하는 값은 `camp.nextstep.edu.missionutils.Console`의 `readLine()`을 활용한다.
- `camp.nextstep.edu.missionutils`에서 제공하는 `Randoms` 및 `Console`
  API를 사용하여 구현해야 한다.
    - Random 값 추출은 `camp.nextstep.edu.missionutils.Randoms`의 `pickUniqueNumbersInRange()`를 활용한다.
- Java Enum을 적용한다.
- 제공된 `Lotto` 클래스를 활용해 구현해야 한다.
    - `numbers`의 접근 제어자인 private을 변경할 수 없다.
    - `Lotto`에 필드(인스턴스 변수)를 추가할 수 없다.
    - `Lotto`의 패키지 변경은 가능하다.

### 컨벤션 제약 사항

- indent(인덴트, 들여쓰기) depth를 3이 넘지 않도록 구현한다. 2까지만 허용한다.
- 3항 연산자를 쓰지 않는다.
- 함수(또는 메서드)의 길이가 15라인을 넘어가지 않도록 구현한다.
- else 예약어를 쓰지 않는다.
    - 힌트: if 조건절에서 값을 return하는 방식으로 구현하면 else를 사용하지 않아도 된다.
    - else를 쓰지 말라고 하니 switch/case로 구현하는 경우가 있는데 switch/case도 허용하지 않는다.

### 테스트 요구 사항

- JUnit 5와 AssertJ를 이용하여 본인이 정리한 기능 목록이 정상 동작함을 테스트 코드로 확인한다.
- 도메인 로직에 단위 테스트를 구현해야 한다. 단, UI(System.out, System.in, Scanner) 로직은 제외한다.
    - 핵심 로직을 구현하는 코드와 UI를 담당하는 로직을 분리해 구현한다.
    - 단위 테스트 작성이 익숙하지 않다면 `test/java/lotto/LottoTest`를 참고하여 학습한 후 테스트를 구현한다.
- 프로그램 구현이 완료되면 ApplicationTest의 모든 테스트가 성공해야 한다. 테스트가 실패할 경우 0점 처리한다.

