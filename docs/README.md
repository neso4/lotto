## 👍 2주차 미션 코드 리뷰 피드백
- 함수를 더 작게 분리 ➡️ ex) 범위 검증시 최소, 최대 범위 검증으로 분리
- 클래스 인스턴스 변수, 함수를 줄이기 ➡️ 클래스 분리, 파라미터로 값 전달
- 명확하고 의미있는 네이밍 ➡️ 기능 요구 사항을 몰라도 해석할 수 있도록 작성
- toString 은 디버깅 용도로만 사용 ➡️ 클래스 또는 메소드로 분리
- 클래스에 맞는 패키지 분리 ➡️ MVC 패턴 적용
- 정적 팩토리 메소드, 싱글톤 패턴 활용
- final 키워드를 통한 불변성 보장
- Enum 에서 에러 메시지 처리

---

## 🔎 고민의 흔적

### 명시하지 않은 요구사항
- 로또 구매 금액 범위
  - 실제 로또는 1회 구매 한도가 100,000원. 즉, 20장까지 구매 가능
  - 실제 로또는 5,000원인 것을 고려하여 해당 게임에선 최소 금액 1,000원, 최대 금액 20,000원으로 설정
- 로또 상금 범위
  - 로또 상금 범위의 제한이 없으므로 큰 금액까지 계산할 수 있도록 구현

### MVC 패턴
- model, view 는 controller 의 로직에 의존하지 않도록 구현
- controller 는 게임의 흐름만 관리, 기능적인 부분은 service 에서 구현
- view 에 전달되는 데이터는 DTO 를 통해 구현
- ApplicationConfig 를 통해 DI 를 적용, 확장에 용이하도록 구현
- ConsoleView 를 통해 입출력 방법이 바뀌더라도 비즈니스 로직에 영향이 없도록 구현

### Java Enum
- 단순히 상수만 관리하는 것이 아니라 관련 로직을 함께 처리
  - ex) 당첨 번호와 같은 번호의 개수를 통해 등수를 반환하는 기능
  - ex) 당첨된 로또의 등수와 개수를 통해 등수별로 상금을 계산하는 기능
- EnumMap 을 통해 Enum 을 key 로 사용
- Exception 을 Enum 으로 관리
  - 직접 예외를 발생하는 기능
  - 예외 메시지를 받아오는 기능

### Test
- 하나의 기능이 완성되면 테스트 코드 작성
  - 실패, 성공 테스트를 모두 구현하도록 노력함
  - `@ParameterizedTest`, `@RepeatedTest` 등 활용 -> `@CsvSource`
  - UI 로직을 제외한 도메인 로직 테스트 구현
- 테스트 목적에 맞는 테스트 케이스를 고려
- 테스트를 통해 코드의 논리적 오류뿐만 아니라 예외 케이스를 발견
  - 상금이 정수 최대 범위를 넘어갈 때
  - 수익률 계산에서 무한 소수가 나올 때 
- 테스트 커버리지 (Line, %)
  - controller : 100%
  - dto : 100%
  - exception : 100%
  - model : 100%
  - service : 86%

### Exception
- `InputException` : 입력 형식에 대한 검증만 하도록 구현
  - 구매 금액, 보너스 번호를 입력받을 때 숫자인지만 검증
  - 당첨 번호 입력시 다음과 같은 형식인지를 검증, 아닌 경우 예외 발생 (쉼표 사이에 공백은 허용)
    - `1,2,3,4,5,6` , `1, 2, 3, 4, 5, 6`
- `LottoException` : 로또와 관련된 검증만 하도록 구현
  - 로또 번호와 관련된 검증
  - 구입 금액과 관련된 검증

### 상금 및 수익률 계산
- 1등이 두 번 당첨되는 등 상금이 정수의 최대 범위를 넘어가는 것이 가능하도록 구현 -> `BigInteger`
- 큰 상금에 따른 수익률을 계산할 때 부정확한 소수의 계산을 막도록 구현 -> `BigDecimal`
  - 수익률이 무한 소수가 나와도 계산할 수 있도록 scale 을 설정
  - 정확한 계산을 위해 BigDecimal 의 인자로 String 형식으로 전달
- 소수점 둘째 자리 반올림 -> `DecimalFormat`
  
---

## 🖥 프로그램 흐름 정리

1. `구입 금액을 입력해주세요.` 문구를 출력한다.
<br><br>
2. 사용자로부터 구입 금액을 입력받는다.
<br><br>
3. 사용자가 구매한 로또의 수량을 출력한다.
<br><br>
4. 수량에 맞는 로또를 차례대로 출력한다.
<br><br>
5. `당첨 번호를 입력해주세요.` 문구를 출력한다.
<br><br>
6. 사용자로부터 당첨 번호를 입력받는다.
<br><br>
7. `보너스 번호를 입력해주세요.` 문구를 출력한다.
<br><br>
8. 사용자로부터 보너스 번호를 입력받는다.
<br><br>
9. 당첨 통계를 출력한다.
<br><br>
10. 총 수익률을 출력한다.

--- 

## ⚙️ 기능 목록

### 로또 기능
- [X] 로또 번호 검증 기능
  - [X] 로또 번호는 6개의 숫자로 이루어져야 한다.
  - [X] 로또 번호는 1~45 사이의 숫자로 이루어져야 한다.
  - [X] 로또 번호는 중복 없는 숫자로 이루어져야 한다.
  - [X] `예외사항` : 위 조건을 만족하지 않는다면 `IllegalArgumentException` 발생
- [X] 로또 번호 오름차순 정렬 기능

### 로또 발행 기능
- [X] 1개의 로또를 발행한다.
  - [X] 중복되지 않는 6개의 숫자를 뽑는다.
  - [X] 1~45 사이의 숫자를 뽑는다.
  - [X] `pickUniqueNumbersInRange` 함수를 사용한다.
- [X] 구입한 수량만큼 로또를 발행한다.

### 로또 게임 기능
- [X] 로또 게임을 시작한다.
- [X] 로또 게임을 진행한다.

### 로또 구입 기능
- [X] 로또 구입 금액 입력 요청 메시지를 출력한다.
- [X] 로또 구입 금액을 입력 받는다.
  - [X] `Console.readLine` 함수를 사용한다. 
  - [X] 구입 금액은 숫자여야 한다.
  - [X] 구입 금액은 1,000원 단위여야 한다.
  - [X] 구입 금액은 1,000원 이상 20,000원 이하여야 한다.
  - [X] `예외사항` : 위 조건을 만족하지 않는다면 `[ERROR]`로 시작하는 문구를 출력, 다시 입력 받는다.

### 로또 출력 기능
- [X] 발행한 로또 수량을 출력한다.
- [X] 발행한 수량만큼 로또 번호를 출력한다.
  - [X] 로또 번호는 오름차순으로 정렬한다.

### 당첨 번호 입력 기능
- [X] 당첨 번호 입력 요청 메시지를 출력한다.
- [X] 당첨 번호를 입력받는다.
  - [X] 당첨 번호는 쉼표(,)를 기준으로 구분한다.
  - [X] 당첨 번호는 숫자여야 한다.
  - [X] `예외사항` : 위 조건을 만족하지 않는다면 `[ERROR]`로 시작하는 문구를 출력, 다시 입력 받는다.

### 보너스 번호 입력 기능
- [X] 보너스 번호 입력 요청 메시지를 출력한다.
- [X] 보너스 번호를 입력 받는다.
  - [X] 보너스 번호는 숫자여야 한다.
  - [X] 보너스 번호는 1~45 사이의 숫자여야 한다.
  - [X] 보너스 번호는 당첨 번호에 없는 번호여야 한다.
  - [X] `예외사항` : 위 조건을 만족하지 않는다면 `[ERROR]`로 시작하는 문구를 출력, 다시 입력받는다.
  
### 로또 추첨 기능
- [X] 구매자의 로또와 당첨 로또를 비교한다.
- [X] 당첨된 로또와 같은 번호의 개수와 보너스 번호를 통해 순위를 매긴다.
> 3개 일치 (5,000원) <br>
4개 일치 (50,000원) <br>
5개 일치 (1,500,000원) <br>
5개 일치, 보너스 볼 일치 (30,000,000원) <br>
6개 일치 (2,000,000,000원) <br>

### 당첨 통계 기능
- [X] 당첨 통계 메시지를 출력한다.
- [X] 당첨 통계를 구한다.
- [X] 당첨 통계를 출력한다.

### 총 수익률 기능
- [X] 총 수익률을 출력한다.
  - [X] 수익률은 (당첨 금액 / 구매 금액) x 100 
  - [X] 수익률은 소수점 둘째 자리에서 반올림한다.

---

## 🛠 테스트 목록

### 로또 기능 테스트
- [X] 로또 번호 검증 기능 테스트
  - [X] 로또 번호는 6개의 숫자로 이루어져야 한다.
  - [X] 로또 번호는 1~45 사이의 숫자로 이루어져야 한다.
  - [X] 로또 번호는 중복 없는 숫자로 이루어져야 한다.
  - [X] `예외사항` : 위 조건을 만족하지 않는다면 `IllegalArgumentException` 발생
- [X] 로또 번호 오름차순 정렬 기능 테스트

### 로또 발행 기능 테스트
- [X] 1개의 로또를 발행한다.
- [X] 유효한 로또를 발행한다.
- [X] 구입한 수량만큼 로또를 발행한다.

### 로또 구입 기능 테스트
- [X] 구입 금액은 1,000원 단위여야 한다.
- [X] 구입 금액은 1,000원 이상 20,000원 이하여야 한다.
- [X] `예외사항` : 위 조건을 만족하지 않는다면 `IllegalArgumentException` 발생

### 당첨 로또 기능 테스트
- [X] 보너스 번호 검증 기능 테스트
  - [X] 보너스 번호는 1~45 사이의 숫자로 이루어져야 한다.
  - [X] 보너스 번호는 당첨 로또에 없는 숫자로 이루어져야 한다.
  - [X] `예외사항` : 위 조건을 만족하지 않는다면 `IllegalArgumentException` 발생

### 로또 비교 기능 테스트
- [X] 구매자의 로또와 당첨 로또를 비교한다.
- [X] 당첨된 로또와 같은 번호의 개수와 보너스 번호를 통해 순위를 매긴다.

### 당첨 통계 기능 테스트
- [X] 등수별로 당첨된 로또의 개수를 반환한다.

### 총 수익률 기능 테스트
- [X] 총 수익률을 반환한다.
  - [X] 수익률은 (당첨 금액 / 구매 금액) x 100
  - [X] 수익률은 소수점 둘째 자리에서 반올림한다.