## 💰 FLOW

----
1. 로또 구입 금액을 입력받는다.
    - 구입 금액은 1,000원 단위이다.
      - **1,000원으로 나누어지지 않으면 예외 발생**
    - **정수로 입력이 되지 않으면 예외 발생**
    - **최소 구입 금액은 1,000원이다. -> 0원이 입력되면 예외 발생**
</br></br>
2. 당첨 번호를 입력 받는다.
    - 번호는 쉼표(,)를 기준으로 구분한다.
    - **입력되는 번호가 6개가 아닌 경우 예외 발생**
    - 번호의 범위는 1 ~ 45이다.
      - **이를 벗어나는 범위에서 예외 발생**
    - **숫자가 아닌 입력이 들어오면 예외 발생**
    - **당첨 번호가 중복이 될 경우 예외 발생**
      </br></br>
3. 보너스 번호를 입력받는다.
    - 번호의 범위는 1 ~ 45이다.
      - **이를 벗어나는 범위에서 예외 발생**
    - **숫자가 아닌 입력이 들어오면 예외 발생**
    - **당첨 번호와 중복이 되는 숫자가 입력될 시에 예외 발생**
</br></br>
4. 구입 금액만큼 로또를 발행한다.
    - 로또 한 장당 1000원이다.
    - 번호의 범위는 1 ~ 45이다.
    - 숫자는 중복이 되지 않는다.
</br></br>
5. 발행한 로또를 출력한다
   - 로또 번호는 오름차순으로 정렬된다.
</br></br>
6. 당첨 내역을 출력한다.
   - 당첨 내역은 당첨 번호 + 보너스 번호와 발행한 로또를 비교한다.
     - 1등: 6개 번호 일치 / 2,000,000,000원
     - 2등: 5개 번호 + 보너스 번호 일치 / 30,000,000원
     - 3등: 5개 번호 일치 / 1,500,000원
     - 4등: 4개 번호 일치 / 50,000원
     - 5등: 3개 번호 일치 / 5,000원
</br></br>
7. 수익률을 출력한다.
   - 당첨 내역과 로또 구입 금액으로 수익률을 계산한다.
     - 수익률은 소수점 둘째 자리에서 반올림한다. 
       - e.g. 100.0%, 51.5%, 1,000,000.0% ...

## 🔍 요구 사항 분석

----

- 로또 구입 금액을 입력받는다.
  - [X] 1,000원 단위로 받지 않으면 예외 처리
  - [X] 정수로 입력이 되지 않으면 예외 처리
  - [X] 0원이 들어오면 예외 처리 (최소 금액은 1,000원이다.)
</br></br>
- 당첨 번호를 입력 받는다.
  - [X] 쉼표를 기준으로 파싱한다.
  - [X] 숫자가 6개가 아닌 경우 예외 처리
  - [X] 번호의 범위가 1 ~ 45인지 확인하여 벗어나면 예외 처리
  - [X] 숫자가 아닌 입력이 들어올 시 예외 처리
  - [X] 당첨 번호가 중복이 될 경우 예외 처리
</br></br>
- 보너스 번호를 입력 받는다.
  - [X] 번호의 범위가 1 ~ 45인지 확인하여 벗어나면 예외 처리
  - [X] 숫자가 아닌 입력이 된다면 예외 처리
  - [X] 당첨 번호와 중복이 되는 숫자가 입력되면 예외 처리
</br></br>
- 구입 금액만큼 로또를 발행한다.
  - [X] 임의의 수로 중복이 되지 않는 1 ~ 45 범위의 6개의 숫자를 생성한다. (로또 발행)
  - [X] 발행된 로또를 저장한다.
</br></br>
- 발행한 로또를 출력한다.
  - [X] 발행한 로또를 오름차순으로 정렬하여 출력한다.
</br></br>
- 당첨 내역을 출력한다.
  - [X] 발행한 로또와 당첨 번호를 비교한다.
  - [X] 발행한 로또와 보너스 번호를 비교한다.
  - [X] 당첨 내역을 저장한다.
  - [X] 당첨 내역을 출력한다.
</br></br>
- 수익률을 출력한다.
  - [X] 저장한 당첨 내역과 로또 구입 금액으로 수익률을 계산한다.
  - [X] 총 수익률을 출력한다.

## 📋 기능 명세서

------
## Controller
- GameController
  - InputView에서 InputMoney, InputWinnings, InputBonus와 같은 DTO를 입력받는다.
  - 입력받은 DTO를 LottoService에 넘겨준다.
  - 발행받은 로또(DTO)를 받아 OutputView에 넘겨준다.
  - Lotto 결과(DTO)를 받아서 OutputView에 넘겨준다.
  - Calculator에게 계산된 수익률을 받아 OutputView에 넘겨준다.
## Domain
- Calculator
  - 유저의 돈과 결과를 매개 변수로 받아 수익률을 계산한다.
</br></br>
- Lotto
  - 우테코에서 제공해주는 Class
  - 6개가 아닐 경우 예외처리
  - 중복 숫자가 들어올 경우 예외처리
</br></br>
- LottoRank
  - 1등부터 5등까지의 등수와 그에 따른 상금 및 당첨 메세지를 정의하는 Enum
  - 'of' 메서드를 사용하여 일치하는 숫자 개수와 보너스를 기반으로 랭크를 반환한다.
</br></br>
- LottoResult
  - 랭크별 당첨 횟수를 저장하기 위해 Map을 사용한다.
</br></br>
- PurchasedLotto
  - 구매한 로또 목록을 저장한다.
</br></br>
- User
  - 가지고 있는 금액을 저장한다.
</br></br>
- WinningBonusNumber
  - 로또 당첨 보너스 번호를 저장한다.
  - 보너스 번호가 당첨 번호와 중복이 되는지 검사하기 위해 생성자에 당첨 번호도 매개변수로 받게 하였다.
  - 당첨 번호와 중복이 되는 보너스 번호면 예외 처리
</br></br>
- WinningNumbers
  - 당첨 번호를 저장한다.
## DTO
- InputBonus
  - 사용자가 입력한 보너스 번호에 대해 유효성을 검사하고 저장한다.
  - Console.readline() 반환 값에 따라 String을 int로 변환한다.
</br></br>
- InputMoney
  - 사용자가 입력한 금액에 대해 유효성을 검사하고 저장한다.
  - Console.readline() 반환 값에 따라 String을 int로 변환한다.
</br></br>
- InputWinningNumbers
  - 사용자가 입력한 당첨 번호에 대해 유효성을 검사하고 저장한다.
  - Console.readline() 반환 값에 따라 String을 List<Integer>로 변환한다.
</br></br>
- LottoResultDTO
  - 로또 결과를 OutputView로 보내기 위해 사용된다.
  - LottoResult를 매개 변수로 받아 생성자로 생성한다.
</br></br>
- PurchasedLottoDTO
  - 구매한 로또를 OutputView로 보내기 위해 사용된다.
  - PurchasedLotto를 매개 변수로 받아 생성자로 생성한다.
## Service
- LottoService
  - 사용자가 입력한 금액을 받아 로또를 구매(생성)하고 GameController에 반환한다.
  - 로또 당첨 번호와 보너스 번호를 이용하여 당첨 결과를 확인하고, LottoResult를 반환한다.
  - ResultSerivce를 생성하고 당첨 번호와 보너스 번호를 넘겨줘서 결과에 대한 반환값을 받는다.
  - 사용자가 입력한 금액, 당첨 번호, 보너스 번호에 대한 유효성 검사를 진행하고 반환한다.
</br></br>
- ResultService
  - LottoService의 메서드에서 호출한 곳으로 당첨 결과를 반환한다.
  - 구매한 로또 번호와 당첨 번호를 비교한다.

## Validator
- InputPurchaseAmountValidator
  - 구매 금액 입력에 대한 예외 처리
</br></br>
- InputWinningBonusNumberValidator
  - 보너스 번호에 대한 예외 처리
</br></br>
- InputWinningNumbersValidator
  - 당첨 번호에 대한 예외 처리
## View
- InputView
  - 구매 금액, 당첨 번호, 보너스 번호에 대한 입력을 받아 GameController에 반환된다.
</br></br>
- OutputView
  - GameController에서 받은 DTO를 출력한다.

## 📢 변경점

-----
- 로또 구입 금액에 들어오는 입력 값을 TDD 방법으로 개발하며, 추가적인 예외 상황 발생
  - 정수로 들어오면 경우 예외 처리 추가
  - 0원이 들어오면 에외 처리 추가 (최소 금액은 1,000원이다.)
</br></br>
- 로또 당첨 번호에 들어오는 입력 값을 TDD 방법으로 개발하며, 추가적인 예외 상황 발생
  - 중복되는 값이 입력될 시에 예외 처리 추가
</br></br>
- 당첨 번호와 보너스 번호를 입력할 시에 숫자가 아닌 경우를 Service에서 처리하지 않고 원본 객체에서 처리
  - String으로 입력받은 값을 DTO로 받고 그대로 넘겨줘서 검증을 원본 객체에서 하기 위함
  - 이에 따라 당첨 번호와 보너스 번호는 생성자의 매개 변수로 String을 받도록 변경
</br></br>
- 당첨 번호 입력에 공백이 입력될 시에 예외 처리 추가
  - E.g, 1, 2,3,4, 5,6 에서 2와 5처럼 공백 + 숫자 입력이 들어올 시에 예외가 발생하도록 추가
  - 1,2,3,4,5,6 처럼 붙어서 입력이 들어와야 한다. 
</br></br>
- 발행한 로또와 당첨 내역을 저장하지 않는다.
  - 저장할 필요가 없어짐.
  - 매개 변수로 값을 넘기며 해결
</br></br>
- 유효성 검사를 원본 객체에서 하지 않고 DTO에서 검증
  - 입력받은 데이터를 DTO에서 검증하는 것이 맞다고 판단하여 DTO에서 검증
  - 이에 따라 String으로 입력된 값의 데이터 형식을 DTO에서 처리하여 원본 객체에 저장
</br></br>
- LottoService 내에 필드 멤버로 있던 객체들을 모두 삭제
  - 기존에 LottoService 내에 필드 멤버로 선언하고 다른 메소드에서 재사용했으나, 의존성이 너무 높고 결합이 너무 강하여 제거
  - 이에 따라 View에서 들어온 DTO를 Controller에서 처리하고 원본 객체를 Service로 보내는 구조(매개 변수를 통해)로 변경
     - 이전에는 Controller에서는 DTO만 알고 있고, Service 내에서 원본 객체로 작업했으나 변경됨
##  ✅ Test

------
- **UserTest**
    - public void 구입_금액_천원_단위_테스트()
        - 구입한 금액이 1000원 단위가 아닐 경우 예외가 발생한다.
</br></br>
    -  public void 구입_금액_정수_테스트()
        - 구입한 금액에 정수가 아닌 값이 입력되면 예외가 발생한다.
</br></br>
    - public void 구입_금액_최소_테스트()
        - 구입한 금액이 0원이면 예외가 발생한다.
</br></br>
- **LottoWinningNumbersTest**
  - public void 당첨_번호_정수_테스트()
    - 입력받은 당첨 번호에 정수가 아닌 입력이 있을 경우 예외가 발생한다.
</br></br>
  - public void 당첨_번호_공백_제외_테스트()
    - 입력받은 당첨 번호에 공백이 있을 경우 예외가 발생한다.
</br></br>
  - public void 당첨_번호_6개보다_많은_경우_테스트()
    - 입력받은 당첨 번호가 6개보다 많으면 예외가 발생한다.
</br></br>
  - public void 당첨_번호_6개보다_적은_경우_테스트()
    - 입력받은 당첨 번호가 6개보다 적으면 예외가 발생한다.
</br></br>
  - public void 당첨_번호_범위_테스트()
    - 입력받은 당첨 번호의 범위가 1 ~ 45가 아니면 예외가 발생한다.
</br></br>
  - public void 당첨_번호_중복_테스트()
    - 입력받은 당첨 범위에 중복이 있을 경우 예외가 발생한다.
</br></br>
- **LottoWinningBonusNumberTest**
  - public void 보너스_번호_정수_테스트()
    - 입력받은 보너스 번호가 정수가 아닌 경우 예외가 발생한다.
</br></br>
  - public void 보너스_번호_범위_테스트()
    - 입력받은 보너스 번호의 범위가 1 ~ 45가 아니면 예외가 발생한다.
</br></br>
  - public void 보너스_번호_중복_테스트()
    - 입력받은 보너스 번호가 이미 당첨 번호에 있는 경우 예외가 발생한다.
</br></br>
- **LottoService**
  - public void 로또_구매_테스트()
    - 구입 금액만큼 로또가 생성되는지 검사한다.
  - public void 로또_출력_테스트()
    - 생성된 로또가 출력되는지 검사한다.